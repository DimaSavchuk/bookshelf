{"mappings":"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","sources":["src/js/services/loadingcheck-shopping-list.js","src/js/partials/shoping-list/selected-books.js"],"sourcesContent":["import { authCheck } from '../modals/authorization';\n\n\nwindow.addEventListener('DOMContentLoaded', event => {\n  const layoutElement = document.querySelector('.layout');\n  layoutElement.classList.add('is-loading');\n\n  Promise.all([authCheck()]).then(\n    () => {\n      const loadingElement = document.querySelector('.js-loading');\n      const layoutElement = document.querySelector('.layout');\n\n      loadingElement.classList.add('loading-overlay-hide');\n      layoutElement.classList.remove('is-loading');\n    }\n  );\n});\n","import axios from 'axios';\n//import { save, load } from './localStorageService.js';\nimport { STORAGE_KEY } from '../../modals/about-book';\n\nconst API_URL = 'https://books-backend.p.goit.global/books/top-books';\nconst SHOPPING_LIST_LOCAL_STORAGE_KEY = 'ShoppingList';\nlet booksFromLocalStorage;\n\nconst refs = {\n  sellectedBooksList: document.querySelector('.sellected-books-list'),\n  noBooksSection: document.querySelector('.books-not-available'),\n};\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  // Only for test\n  InitializeShoppingListTest();\n  InitializeShoppingList();\n});\n\nfunction InitializeShoppingList() {\n  booksFromLocalStorage = load(STORAGE_KEY);\n\n  if (booksFromLocalStorage && booksFromLocalStorage.length > 0) {\n    renderBooks();\n    hideEmptyMessage();\n    setPagination(1);\n  } else {\n    paginationContainer.style.display = 'none';\n  }\n}\n\nfunction hideEmptyMessage() {\n  refs.noBooksSection.style.display = 'none';\n}\n\nfunction showEmptyMessage() {\n  refs.noBooksSection.style.display = 'block';\n}\n\nfunction renderBooks() {\n  let markupBooks = booksFromLocalStorage\n    .map(\n      ({\n        _id,\n        title,\n        author,\n        book_image,\n        description,\n        list_name,\n        buy_links,\n      }) => {\n        let amazonLink = buy_links.find(book => book.name == 'Amazon').url;\n        let appleLink = buy_links.find(book => book.name == 'Apple Books').url;\n        let bookshopLink = buy_links.find(book => book.name == 'Bookshop').url;\n        return `<li id=\"${_id}\" class=\"book-item\">\n            <img src=\"${book_image}\" alt=\"${title}\" class=\"book-image\" />\n            <div class=\"book-info\">\n            <div class=\"book-style\">\n            <h2 class=\"book-title\">${title}</h2>\n            \n            <div>\n            <button id=\"${_id}\" class=\"delete-book-button\"></button>\n            </div>\n            </div>\n            \n            <p class=\"book-category\">${list_name}</p>\n            <p class=\"book-description\">David Burroughs was once a devoted father to his three-year-old son Matthew, living a dream life just a short drive away from the working-class suburb where he and his wife, Cheryl, first fell in love--until one fateful night when David woke suddenly to discover Matthew had been murdered while David was asleep just down the hall.</p>\n            <div class=\"book-styles\">\n            <h3 class=\"book-author\">${author}</h3>\n            <div class=\"trading-platforms-list list\">\n            <a href=\"\"></a>\n            <a href=\"${amazonLink}\" class=\"amazon\"></a>\n            <a href=\"${appleLink}\" class=\"apple\"></a>\n            <a href=\"${bookshopLink}\" class=\"shop\"></a>\n            </div>\n            </div>\n            </div>\n        </li>`;\n      }\n    )\n    .join('');\n  refs.sellectedBooksList.insertAdjacentHTML('beforeend', markupBooks);\n  bindDeleteButtonsEvents();\n}\n\nfunction bindDeleteButtonsEvents() {\n  let deleteButtonRefs = document.querySelectorAll('.delete-book-button');\n  deleteButtonRefs.forEach(book => book.addEventListener('click', deleteBook));\n}\n\nfunction deleteBook(e) {\n  const bookId = e.srcElement.id;\n  deleteBookFromLocalStorage(bookId);\n  deleteBookFromList(bookId);\n\n  if (!booksFromLocalStorage || booksFromLocalStorage.length < 1) {\n    showEmptyMessage();\n    paginationContainer.style.display = 'none';\n  } else {\n    clearPage();\n    renderBooks();\n    setPagination(currentPage);\n  }\n}\n\nfunction deleteBookFromLocalStorage(bookId) {\n  booksFromLocalStorage = booksFromLocalStorage.filter(\n    book => book._id !== bookId\n  );\n  save(SHOPPING_LIST_LOCAL_STORAGE_KEY, booksFromLocalStorage);\n}\n\nfunction deleteBookFromList(bookId) {\n  const bookElement = document.getElementById(bookId.toString());\n  bookElement.remove();\n}\n\nfunction clearPage(){\n  refs.sellectedBooksList.innerHTML = '';\n  paginationNumbers.innerHTML = '';\n}\n\n// Only for test\nasync function InitializeShoppingListTest() {\n\n      try {\n        let mappedBookList;\n        const response = await axios.get(`${API_URL}`);\n        if(response && response.data)\n        {\n            let bookslist = response.data[0].books;\n            bookslist = bookslist.concat(response.data[1].books);\n            bookslist = bookslist.concat(response.data[2].books);\n\n            mappedBookList = bookslist.map(({\n                _id,\n                title,\n                author,\n                book_image,\n                description,\n                list_name,\n                buy_links,\n            }) =>  ({ _id, title, author, book_image, description, list_name, buy_links }));\n        }\n        if(mappedBookList && mappedBookList.length > 0) {\n            save(SHOPPING_LIST_LOCAL_STORAGE_KEY, mappedBookList);\n        }\n\n        return response.data;\n      } catch (error) {\n         console.error(error.toJSON());\n      }\n    }\n\n//LocalStorageService\nconst save = (key, value) => {\n  try {\n    const serializedState = JSON.stringify(value);\n    localStorage.setItem(key, serializedState);\n  } catch (error) {\n    console.error('Set state error: ', error.message);\n  }\n};\n\nconst load = key => {\n  try {\n    const serializedState = localStorage.getItem(key);\n    return serializedState === null ? undefined : JSON.parse(serializedState);\n  } catch (error) {\n    console.error('Get state error: ', error.message);\n  }\n};\n// --------------------------\n\n\n\n\n\n//    Pagination\nconst paginationNumbers = document.getElementById('pagination-numbers');\nconst paginatedList = document.getElementById('paginated-list');\nconst nextButton = document.getElementById('next-button');\nconst prevButton = document.getElementById('prev-button');\nconst paginationContainer = document.getElementById('pagination-container');\nlet listItems;\nconst paginationLimit = window.screen.width >= 768 ? 3 : 4;\nlet pageCount;\nlet currentPage;\n\nfunction setPagination(page) {\n  listItems = paginatedList.querySelectorAll('li');\n  pageCount = Math.ceil(listItems.length / paginationLimit);\n\n  if (pageCount < 2) {\n    paginationContainer.style.display = 'none';\n    return;\n  }\n\n  if(page > pageCount){\n    page = pageCount;\n  }\n\n  getPaginationNumbers();\n  setCurrentPage(page);\n  setNextAndPreviousButtons();\n\n  document.querySelectorAll('.pagination-number').forEach(button => {\n    const pageIndex = Number(button.getAttribute('page-index'));\n    if (pageIndex) {\n      button.addEventListener('click', () => {\n        setCurrentPage(pageIndex);\n      });\n    }\n  });\n}\n\nconst getPaginationNumbers = () => {\n  for (let i = 1; i <= pageCount; i++) {\n    appendPageNumber(i);\n  }\n};\n\nconst appendPageNumber = index => {\n  const pageNumber = document.createElement('button');\n  pageNumber.className = 'pagination-number';\n  pageNumber.innerHTML = index;\n  pageNumber.setAttribute('page-index', index);\n  pageNumber.setAttribute('aria-label', 'Page ' + index);\n  paginationNumbers.appendChild(pageNumber);\n};\n\nconst setCurrentPage = pageNum => {\n  currentPage = pageNum;\n\n  handleActivePageNumber();\n  handlePageButtonsStatus();\n\n  const prevRange = (pageNum - 1) * paginationLimit;\n  const currRange = pageNum * paginationLimit;\n\n  listItems.forEach((item, index) => {\n    item.style.display = 'none';\n    if (index >= prevRange && index < currRange) {\n      item.style.display = 'flex';\n    }\n  });\n};\n\nfunction setNextAndPreviousButtons() {\n  prevButton.addEventListener('click', () => {\n    setCurrentPage(currentPage - 1);\n  });\n  nextButton.addEventListener('click', () => {\n    setCurrentPage(currentPage + 1);\n  });\n}\n\nconst handleActivePageNumber = () => {\n  document.querySelectorAll('.pagination-number').forEach(button => {\n    button.classList.remove('active');\n\n    const pageIndex = Number(button.getAttribute('page-index'));\n    if (pageIndex == currentPage) {\n      button.classList.add('active');\n    }\n  });\n};\n\nconst disableButton = button => {\n  button.classList.add('disabled');\n  button.setAttribute('disabled', true);\n};\n\nconst enableButton = button => {\n  button.classList.remove('disabled');\n  button.removeAttribute('disabled');\n};\n\nconst handlePageButtonsStatus = () => {\n  if (currentPage === 1) {\n    disableButton(prevButton);\n  } else {\n    enableButton(prevButton);\n  }\n  if (pageCount === currentPage) {\n    disableButton(nextButton);\n  } else {\n    enableButton(nextButton);\n  }\n};"],"names":["$7Pen5","parcelRequire","window","addEventListener","event","document","querySelector","classList","add","Promise","all","authCheck","then","loadingElement","layoutElement","remove","$2shzp","$acdd5c8a1c351adc$var$booksFromLocalStorage","$acdd5c8a1c351adc$var$refs","sellectedBooksList","noBooksSection","$acdd5c8a1c351adc$var$renderBooks","markupBooks","map","_id","title","author","book_image","description","list_name","buy_links","find","book","name","url","join","insertAdjacentHTML","querySelectorAll","forEach","$acdd5c8a1c351adc$var$deleteBook","e","bookId","srcElement","id","filter","$acdd5c8a1c351adc$var$save","$acdd5c8a1c351adc$var$deleteBookFromLocalStorage","getElementById","toString","$acdd5c8a1c351adc$var$deleteBookFromList","length","style","display","$acdd5c8a1c351adc$var$paginationContainer","innerHTML","$acdd5c8a1c351adc$var$paginationNumbers","$acdd5c8a1c351adc$var$setPagination","$acdd5c8a1c351adc$var$currentPage","async","mappedBookList","response","default","get","data","bookslist","books","concat","error","console","toJSON","$acdd5c8a1c351adc$var$InitializeShoppingListTest","$acdd5c8a1c351adc$var$load","$iOyVp","STORAGE_KEY","key","value","serializedState","JSON","stringify","localStorage","setItem","message","getItem","undefined","parse","$acdd5c8a1c351adc$var$paginatedList","$acdd5c8a1c351adc$var$nextButton","$acdd5c8a1c351adc$var$prevButton","$acdd5c8a1c351adc$var$listItems","$acdd5c8a1c351adc$var$paginationLimit","screen","width","$acdd5c8a1c351adc$var$pageCount","page","Math","ceil","$acdd5c8a1c351adc$var$getPaginationNumbers","$acdd5c8a1c351adc$var$setCurrentPage","button","pageIndex","Number","getAttribute","i","$acdd5c8a1c351adc$var$appendPageNumber","index","pageNumber","createElement","className","setAttribute","appendChild","pageNum","$acdd5c8a1c351adc$var$handleActivePageNumber","$acdd5c8a1c351adc$var$handlePageButtonsStatus","prevRange","currRange","item","$acdd5c8a1c351adc$var$disableButton","$acdd5c8a1c351adc$var$enableButton","removeAttribute"],"version":3,"file":"shoping-list.4d8f4536.js.map"}